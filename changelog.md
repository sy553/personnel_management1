# 更新日志

## [2024-12-07] 允许员工记录不关联用户账号

### 改动
1. 修改数据库结构，允许员工表的 `user_id` 字段为空
   - 创建并执行数据库迁移脚本 `allow_null_user_id.py`
   - 修改外键约束，使其支持空值

2. 更新代码逻辑
   - 修改 `Employee` 模型，将 `user_id` 字段设置为可空
   - 更新 `employee_service.py` 中的创建员工逻辑，支持不指定 `user_id`
   - 添加用户存在性检查，只在提供 `user_id` 时进行验证

### 原因
为了支持创建没有系统登录账号的员工记录。这样可以先添加员工基本信息，之后再根据需要创建对应的用户账号。

### 技术细节
- 使用 SQLAlchemy 的 `nullable=True` 参数允许字段为空
- 通过 SQL ALTER TABLE 语句修改数据库约束
- 在创建员工时增加了条件检查，只在提供 `user_id` 时验证用户是否存在

### 测试
- 创建测试脚本 `test_create_employee.py` 验证新功能
- 测试了不带 `user_id` 的员工创建功能
- 验证了数据库约束修改是否成功
